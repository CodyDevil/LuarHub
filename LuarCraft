local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local StatsService = game:GetService("Stats")
local RunService = game:GetService("RunService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

-- Wait for PlayerGui to ensure proper initialization
wait(0.1)

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "LunarHub"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global
screenGui.Enabled = true
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui", 5)
if not screenGui.Parent then
    warn("Failed to parent ScreenGui to PlayerGui")
    return
end
screenGui.Parent = LocalPlayer.PlayerGui

-- Create Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 320, 0, 350)
mainFrame.Position = UDim2.new(0.5, -170, 0.5, -175)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
mainFrame.BorderSizePixel = 0
mainFrame.ZIndex = 1000
mainFrame.Visible = true
mainFrame.Parent = screenGui

local uicorner = Instance.new("UICorner")
uicorner.CornerRadius = UDim.new(0, 10)
uicorner.Parent = mainFrame

-- Main Title with "Lunar Hub" - Positioned more to the right
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -85, 0, 40)
title.Position = UDim2.new(0, 35, 0, 0)
title.BackgroundTransparency = 1
title.Text = "Lunar Hub"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 18
title.Font = Enum.Font.SourceSansBold
title.TextXAlignment = Enum.TextXAlignment.Center
title.ZIndex = 1001
title.RichText = true
title.Parent = mainFrame

local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 25, 0, 25)
closeButton.Position = UDim2.new(1, -35, 0, 7.5)
closeButton.BackgroundTransparency = 1
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 16
closeButton.Font = Enum.Font.SourceSansBold
closeButton.ZIndex = 1001
closeButton.Parent = mainFrame

local uicornerClose = Instance.new("UICorner")
uicornerClose.CornerRadius = UDim.new(0, 5)
uicornerClose.Parent = closeButton

-- Create Scrolling Frame for Buttons
local scrollingFrame = Instance.new("ScrollingFrame")
scrollingFrame.Size = UDim2.new(1, -20, 0, 240)
scrollingFrame.Position = UDim2.new(0, 10, 0, 50)
scrollingFrame.BackgroundTransparency = 1
scrollingFrame.ZIndex = 1001
scrollingFrame.CanvasSize = UDim2.new(0, 0, 2, 0)
scrollingFrame.ScrollBarThickness = 6
scrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
scrollingFrame.Parent = mainFrame

local uiListLayout = Instance.new("UIListLayout")
uiListLayout.Padding = UDim.new(0, 6)
uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
uiListLayout.Parent = scrollingFrame

-- Home Buttons
local infiniteYieldButton = Instance.new("TextButton")
infiniteYieldButton.Size = UDim2.new(1, 0, 0, 40)
infiniteYieldButton.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
infiniteYieldButton.Text = "Infinite Yield"
infiniteYieldButton.TextColor3 = Color3.fromRGB(255, 255, 255)
infiniteYieldButton.TextSize = 14
infiniteYieldButton.Font = Enum.Font.SourceSansBold
infiniteYieldButton.ZIndex = 1002
infiniteYieldButton.LayoutOrder = 1
infiniteYieldButton.Parent = scrollingFrame

local uicornerIY = Instance.new("UICorner")
uicornerIY.CornerRadius = UDim.new(0, 8)
uicornerIY.Parent = infiniteYieldButton

local simpleSpyButton = Instance.new("TextButton")
simpleSpyButton.Size = UDim2.new(1, 0, 0, 40)
simpleSpyButton.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
simpleSpyButton.Text = "Simple Spy"
simpleSpyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
simpleSpyButton.TextSize = 14
simpleSpyButton.Font = Enum.Font.SourceSansBold
simpleSpyButton.ZIndex = 1002
simpleSpyButton.LayoutOrder = 2
simpleSpyButton.Parent = scrollingFrame

local uicornerSS = Instance.new("UICorner")
uicornerSS.CornerRadius = UDim.new(0, 8)
uicornerSS.Parent = simpleSpyButton

local dexExplorerButton = Instance.new("TextButton")
dexExplorerButton.Size = UDim2.new(1, 0, 0, 40)
dexExplorerButton.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
dexExplorerButton.Text = "Dex Explorer"
dexExplorerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
dexExplorerButton.TextSize = 14
dexExplorerButton.Font = Enum.Font.SourceSansBold
dexExplorerButton.ZIndex = 1002
dexExplorerButton.LayoutOrder = 3
dexExplorerButton.Parent = scrollingFrame

local uicornerDE = Instance.new("UICorner")
uicornerDE.CornerRadius = UDim.new(0, 8)
uicornerDE.Parent = dexExplorerButton

local remoteFinderV2Button = Instance.new("TextButton")
remoteFinderV2Button.Size = UDim2.new(1, 0, 0, 40)
remoteFinderV2Button.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
remoteFinderV2Button.Text = "Remote Finder 2"
remoteFinderV2Button.TextColor3 = Color3.fromRGB(255, 255, 255)
remoteFinderV2Button.TextSize = 14
remoteFinderV2Button.Font = Enum.Font.SourceSansBold
remoteFinderV2Button.ZIndex = 1002
remoteFinderV2Button.LayoutOrder = 4
remoteFinderV2Button.Parent = scrollingFrame

local uicornerRFV2 = Instance.new("UICorner")
uicornerRFV2.CornerRadius = UDim.new(0, 8)
uicornerRFV2.Parent = remoteFinderV2Button

-- Coordenadas Toggle
local coordenadasToggle = Instance.new("Frame")
coordenadasToggle.Size = UDim2.new(1, 0, 0, 40)
coordenadasToggle.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
coordenadasToggle.ZIndex = 1002
coordenadasToggle.LayoutOrder = 5
coordenadasToggle.Parent = scrollingFrame

local uicornerCoordToggle = Instance.new("UICorner")
uicornerCoordToggle.CornerRadius = UDim.new(0, 8)
uicornerCoordToggle.Parent = coordenadasToggle

local coordenadasLabel = Instance.new("TextLabel")
coordenadasLabel.Size = UDim2.new(0.7, 0, 1, 0)
coordenadasLabel.BackgroundTransparency = 1
coordenadasLabel.Text = "Coordenadas"
coordenadasLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
coordenadasLabel.TextSize = 14
coordenadasLabel.Font = Enum.Font.SourceSansBold
coordenadasLabel.TextXAlignment = Enum.TextXAlignment.Left
coordenadasLabel.Position = UDim2.new(0, 15, 0, 0)
coordenadasLabel.ZIndex = 1003
coordenadasLabel.Parent = coordenadasToggle

local coordenadasSwitch = Instance.new("Frame")
coordenadasSwitch.Size = UDim2.new(0, 45, 0, 22)
coordenadasSwitch.Position = UDim2.new(1, -60, 0.5, -11)
coordenadasSwitch.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
coordenadasSwitch.ZIndex = 1003
coordenadasSwitch.Parent = coordenadasToggle

local coordenadasSwitchCorner = Instance.new("UICorner")
coordenadasSwitchCorner.CornerRadius = UDim.new(0.5, 0)
coordenadasSwitchCorner.Parent = coordenadasSwitch

local coordenadasKnob = Instance.new("Frame")
coordenadasKnob.Size = UDim2.new(0, 18, 0, 18)
coordenadasKnob.Position = UDim2.new(0, 2, 0, 2)
coordenadasKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
coordenadasKnob.ZIndex = 1004
coordenadasKnob.Parent = coordenadasSwitch

local coordenadasKnobCorner = Instance.new("UICorner")
coordenadasKnobCorner.CornerRadius = UDim.new(0.5, 0)
coordenadasKnobCorner.Parent = coordenadasKnob

local coordenadasButton = Instance.new("TextButton")
coordenadasButton.Size = UDim2.new(1, 0, 1, 0)
coordenadasButton.BackgroundTransparency = 1
coordenadasButton.Text = ""
coordenadasButton.ZIndex = 1005
coordenadasButton.Parent = coordenadasToggle

-- Settings Toggles and Buttons
local keybindToggle = Instance.new("TextButton")
keybindToggle.Size = UDim2.new(1, 0, 0, 40)
keybindToggle.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
keybindToggle.Text = "KeyBind: LeftControl"
keybindToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
keybindToggle.TextSize = 14
keybindToggle.Font = Enum.Font.SourceSansBold
keybindToggle.ZIndex = 1002
keybindToggle.LayoutOrder = 1
keybindToggle.Visible = false
keybindToggle.Parent = scrollingFrame

local uicornerKT = Instance.new("UICorner")
uicornerKT.CornerRadius = UDim.new(0, 8)
uicornerKT.Parent = keybindToggle

local pingToggle = Instance.new("Frame")
pingToggle.Size = UDim2.new(1, 0, 0, 40)
pingToggle.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
pingToggle.ZIndex = 1002
pingToggle.LayoutOrder = 2
pingToggle.Visible = false
pingToggle.Parent = scrollingFrame

local uicornerPingToggle = Instance.new("UICorner")
uicornerPingToggle.CornerRadius = UDim.new(0, 8)
uicornerPingToggle.Parent = pingToggle

local pingLabel = Instance.new("TextLabel")
pingLabel.Size = UDim2.new(0.7, 0, 1, 0)
pingLabel.BackgroundTransparency = 1
pingLabel.Text = "Show Ping"
pingLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
pingLabel.TextSize = 14
pingLabel.Font = Enum.Font.SourceSansBold
pingLabel.TextXAlignment = Enum.TextXAlignment.Left
pingLabel.Position = UDim2.new(0, 15, 0, 0)
pingLabel.ZIndex = 1003
pingLabel.Parent = pingToggle

local pingSwitch = Instance.new("Frame")
pingSwitch.Size = UDim2.new(0, 45, 0, 22)
pingSwitch.Position = UDim2.new(1, -60, 0.5, -11)
pingSwitch.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
pingSwitch.ZIndex = 1003
pingSwitch.Parent = pingToggle

local pingSwitchCorner = Instance.new("UICorner")
pingSwitchCorner.CornerRadius = UDim.new(0.5, 0)
pingSwitchCorner.Parent = pingSwitch

local pingKnob = Instance.new("Frame")
pingKnob.Size = UDim2.new(0, 18, 0, 18)
pingKnob.Position = UDim2.new(0, 2, 0, 2)
pingKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
pingKnob.ZIndex = 1004
pingKnob.Parent = pingSwitch

local pingKnobCorner = Instance.new("UICorner")
pingKnobCorner.CornerRadius = UDim.new(0.5, 0)
pingKnobCorner.Parent = pingKnob

local pingButton = Instance.new("TextButton")
pingButton.Size = UDim2.new(1, 0, 1, 0)
pingButton.BackgroundTransparency = 1
pingButton.Text = ""
pingButton.ZIndex = 1005
pingButton.Parent = pingToggle

local fpsToggle = Instance.new("Frame")
fpsToggle.Size = UDim2.new(1, 0, 0, 40)
fpsToggle.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
fpsToggle.ZIndex = 1002
fpsToggle.LayoutOrder = 3
fpsToggle.Visible = false
fpsToggle.Parent = scrollingFrame

local uicornerFpsToggle = Instance.new("UICorner")
uicornerFpsToggle.CornerRadius = UDim.new(0, 8)
uicornerFpsToggle.Parent = fpsToggle

local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(0.7, 0, 1, 0)
fpsLabel.BackgroundTransparency = 1
fpsLabel.Text = "Show Fps"
fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
fpsLabel.TextSize = 14
fpsLabel.Font = Enum.Font.SourceSansBold
fpsLabel.TextXAlignment = Enum.TextXAlignment.Left
fpsLabel.Position = UDim2.new(0, 15, 0, 0)
fpsLabel.ZIndex = 1003
fpsLabel.Parent = fpsToggle

local fpsSwitch = Instance.new("Frame")
fpsSwitch.Size = UDim2.new(0, 45, 0, 22)
fpsSwitch.Position = UDim2.new(1, -60, 0.5, -11)
fpsSwitch.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
fpsSwitch.ZIndex = 1003
fpsSwitch.Parent = fpsToggle

local fpsSwitchCorner = Instance.new("UICorner")
fpsSwitchCorner.CornerRadius = UDim.new(0.5, 0)
fpsSwitchCorner.Parent = fpsSwitch

local fpsKnob = Instance.new("Frame")
fpsKnob.Size = UDim2.new(0, 18, 0, 18)
fpsKnob.Position = UDim2.new(0, 2, 0, 2)
fpsKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
fpsKnob.ZIndex = 1004
fpsKnob.Parent = fpsSwitch

local fpsKnobCorner = Instance.new("UICorner")
fpsKnobCorner.CornerRadius = UDim.new(0.5, 0)
fpsKnobCorner.Parent = fpsKnob

local fpsButton = Instance.new("TextButton")
fpsButton.Size = UDim2.new(1, 0, 1, 0)
fpsButton.BackgroundTransparency = 1
fpsButton.Text = ""
fpsButton.ZIndex = 1005
fpsButton.Parent = fpsToggle

local rejoinButton = Instance.new("TextButton")
rejoinButton.Size = UDim2.new(1, 0, 0, 40)
rejoinButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
rejoinButton.Text = "Rejoin"
rejoinButton.TextColor3 = Color3.fromRGB(255, 255, 255)
rejoinButton.TextSize = 14
rejoinButton.Font = Enum.Font.SourceSansBold
rejoinButton.ZIndex = 1002
rejoinButton.LayoutOrder = 4
rejoinButton.Visible = false
rejoinButton.Parent = scrollingFrame

local uicornerRJ = Instance.new("UICorner")
uicornerRJ.CornerRadius = UDim.new(0, 8)
uicornerRJ.Parent = rejoinButton

local serverHopButton = Instance.new("TextButton")
serverHopButton.Size = UDim2.new(1, 0, 0, 40)
serverHopButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
serverHopButton.Text = "ServerHop"
serverHopButton.TextColor3 = Color3.fromRGB(255, 255, 255)
serverHopButton.TextSize = 14
serverHopButton.Font = Enum.Font.SourceSansBold
serverHopButton.ZIndex = 1002
serverHopButton.LayoutOrder = 5
serverHopButton.Visible = false
serverHopButton.Parent = scrollingFrame

local uicornerSH = Instance.new("UICorner")
uicornerSH.CornerRadius = UDim.new(0, 8)
uicornerSH.Parent = serverHopButton

-- Player Tab Elements
local playerModsToggle = Instance.new("Frame")
playerModsToggle.Size = UDim2.new(1, 0, 0, 40)
playerModsToggle.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
playerModsToggle.ZIndex = 1002
playerModsToggle.LayoutOrder = 1
playerModsToggle.Visible = false
playerModsToggle.Parent = scrollingFrame

local uicornerPlayerToggle = Instance.new("UICorner")
uicornerPlayerToggle.CornerRadius = UDim.new(0, 8)
uicornerPlayerToggle.Parent = playerModsToggle

local playerModsLabel = Instance.new("TextLabel")
playerModsLabel.Size = UDim2.new(0.7, 0, 1, 0)
playerModsLabel.BackgroundTransparency = 1
playerModsLabel.Text = "Player Mods"
playerModsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
playerModsLabel.TextSize = 14
playerModsLabel.Font = Enum.Font.SourceSansBold
playerModsLabel.TextXAlignment = Enum.TextXAlignment.Left
playerModsLabel.Position = UDim2.new(0, 15, 0, 0)
playerModsLabel.ZIndex = 1003
playerModsLabel.Parent = playerModsToggle

local playerModsSwitch = Instance.new("Frame")
playerModsSwitch.Size = UDim2.new(0, 45, 0, 22)
playerModsSwitch.Position = UDim2.new(1, -60, 0.5, -11)
playerModsSwitch.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
playerModsSwitch.ZIndex = 1003
playerModsSwitch.Parent = playerModsToggle

local playerModsSwitchCorner = Instance.new("UICorner")
playerModsSwitchCorner.CornerRadius = UDim.new(0.5, 0)
playerModsSwitchCorner.Parent = playerModsSwitch

local playerModsKnob = Instance.new("Frame")
playerModsKnob.Size = UDim2.new(0, 18, 0, 18)
playerModsKnob.Position = UDim2.new(0, 2, 0, 2)
playerModsKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
playerModsKnob.ZIndex = 1004
playerModsKnob.Parent = playerModsSwitch

local playerModsKnobCorner = Instance.new("UICorner")
playerModsKnobCorner.CornerRadius = UDim.new(0.5, 0)
playerModsKnobCorner.Parent = playerModsKnob

local playerModsButton = Instance.new("TextButton")
playerModsButton.Size = UDim2.new(1, 0, 1, 0)
playerModsButton.BackgroundTransparency = 1
playerModsButton.Text = ""
playerModsButton.ZIndex = 1005
playerModsButton.Parent = playerModsToggle

-- Function to create slider
local function createSlider(parent, name, min, max, default, layoutOrder)
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Size = UDim2.new(1, 0, 0, 50)
    sliderFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    sliderFrame.ZIndex = 1002
    sliderFrame.LayoutOrder = layoutOrder
    sliderFrame.Visible = false
    sliderFrame.Parent = parent

    local uicornerSlider = Instance.new("UICorner")
    uicornerSlider.CornerRadius = UDim.new(0, 8)
    uicornerSlider.Parent = sliderFrame

    local sliderLabel = Instance.new("TextLabel")
    sliderLabel.Size = UDim2.new(0.5, 0, 0, 20)
    sliderLabel.Position = UDim2.new(0, 10, 0, 5)
    sliderLabel.BackgroundTransparency = 1
    sliderLabel.Text = name
    sliderLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    sliderLabel.TextSize = 14
    sliderLabel.Font = Enum.Font.SourceSansBold
    sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
    sliderLabel.ZIndex = 1003
    sliderLabel.Parent = sliderFrame

    local valueLabel = Instance.new("TextLabel")
    valueLabel.Size = UDim2.new(0.2, 0, 0, 20)
    valueLabel.Position = UDim2.new(0.75, 0, 0, 5) -- Moved slightly to the left
    valueLabel.BackgroundTransparency = 1
    valueLabel.Text = tostring(default)
    valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    valueLabel.TextSize = 14
    valueLabel.Font = Enum.Font.SourceSans
    valueLabel.TextXAlignment = Enum.TextXAlignment.Right
    valueLabel.ZIndex = 1003
    valueLabel.Parent = sliderFrame

    local bar = Instance.new("Frame")
    bar.Size = UDim2.new(1, -20, 0, 10)
    bar.Position = UDim2.new(0, 10, 0, 30)
    bar.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    bar.ZIndex = 1003
    bar.Parent = sliderFrame

    local barCorner = Instance.new("UICorner")
    barCorner.CornerRadius = UDim.new(0, 5)
    barCorner.Parent = bar

    local fill = Instance.new("Frame")
    fill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
    fill.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
    fill.ZIndex = 1004
    fill.Parent = bar

    local fillCorner = Instance.new("UICorner")
    fillCorner.CornerRadius = UDim.new(0, 5)
    fillCorner.Parent = fill

    local draggingSlider = false
    bar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            draggingSlider = true
        end
    end)
    bar.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            draggingSlider = false
        end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if draggingSlider and input.UserInputType == Enum.UserInputType.MouseMovement then
            local relativeX = math.clamp((input.Position.X - bar.AbsolutePosition.X) / bar.AbsoluteSize.X, 0, 1)
            fill.Size = UDim2.new(relativeX, 0, 1, 0)
            local value = math.floor(min + relativeX * (max - min))
            valueLabel.Text = tostring(value)
        end
    end)

    return sliderFrame, function()
        return tonumber(valueLabel.Text)
    end
end

local walkSpeedSlider, getWalkSpeed = createSlider(scrollingFrame, "WalkSpeed", 0, 200, 16, 2)
local jumpPowerSlider, getJumpPower = createSlider(scrollingFrame, "JumpPower", 0, 500, 50, 3)

-- Navigation Tabs
local tabHome = Instance.new("TextButton")
tabHome.Size = UDim2.new(0, 60, 0, 30)
tabHome.Position = UDim2.new(0.5, -100, 1, -40)
tabHome.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
tabHome.Text = "Home"
tabHome.TextColor3 = Color3.fromRGB(255, 255, 255)
tabHome.TextSize = 14
tabHome.Font = Enum.Font.SourceSansBold
tabHome.ZIndex = 1001
tabHome.Parent = mainFrame

local uicornerTabHome = Instance.new("UICorner")
uicornerTabHome.CornerRadius = UDim.new(0, 8)
uicornerTabHome.Parent = tabHome

local tabPlayer = Instance.new("TextButton")
tabPlayer.Size = UDim2.new(0, 60, 0, 30)
tabPlayer.Position = UDim2.new(0.5, -30, 1, -40)
tabPlayer.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
tabPlayer.Text = "Player"
tabPlayer.TextColor3 = Color3.fromRGB(255, 255, 255)
tabPlayer.TextSize = 14
tabPlayer.Font = Enum.Font.SourceSansBold
tabPlayer.ZIndex = 1001
tabPlayer.Parent = mainFrame

local uicornerTabPlayer = Instance.new("UICorner")
uicornerTabPlayer.CornerRadius = UDim.new(0, 8)
uicornerTabPlayer.Parent = tabPlayer

local tabSettings = Instance.new("TextButton")
tabSettings.Size = UDim2.new(0, 60, 0, 30)
tabSettings.Position = UDim2.new(0.5, 40, 1, -40)
tabSettings.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
tabSettings.Text = "Settings"
tabSettings.TextColor3 = Color3.fromRGB(255, 255, 255)
tabSettings.TextSize = 14
tabSettings.Font = Enum.Font.SourceSansBold
tabSettings.ZIndex = 1001
tabSettings.Parent = mainFrame

local uicornerTabSettings = Instance.new("UICorner")
uicornerTabSettings.CornerRadius = UDim.new(0, 8)
uicornerTabSettings.Parent = tabSettings

-- Drag Functionality for Main Frame (only on title bar)
local dragging, dragInput, dragStart, startPos
title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

title.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Variables
local isGuiVisible = true
local currentKeybind = Enum.KeyCode.LeftControl
local isListeningForKeybind = false
local isCoordActive = false
local isPingActive = false
local isFpsActive = false
local isPlayerModsActive = false

-- Coordenadas Interface
local coordFrame = Instance.new("Frame")
coordFrame.Size = UDim2.new(0, 180, 0, 70)
coordFrame.Position = UDim2.new(0, 10, 1, -80)
coordFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
coordFrame.BorderSizePixel = 0
coordFrame.ZIndex = 1000
coordFrame.Visible = false
coordFrame.Parent = screenGui

local uicornerCoord = Instance.new("UICorner")
uicornerCoord.CornerRadius = UDim.new(0, 8)
uicornerCoord.Parent = coordFrame

local coordTitle = Instance.new("TextLabel")
coordTitle.Size = UDim2.new(1, 0, 0, 15)
coordTitle.Position = UDim2.new(0, 0, 0, 2)
coordTitle.BackgroundTransparency = 1
coordTitle.Text = "Coordenadas"
coordTitle.TextColor3 = Color3.fromRGB(140, 140, 140)
coordTitle.TextSize = 14
coordTitle.Font = Enum.Font.SourceSansBold
coordTitle.ZIndex = 1001
coordTitle.Parent = coordFrame

local coordLabel = Instance.new("TextLabel")
coordLabel.Size = UDim2.new(1, -10, 0, 25)
coordLabel.Position = UDim2.new(0, 5, 0, 17)
coordLabel.BackgroundTransparency = 1
coordLabel.Text = "X 1234.0 Y 1234.0 Z 1234.0"
coordLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
coordLabel.TextSize = 16
coordLabel.Font = Enum.Font.SourceSans
coordLabel.ZIndex = 1001
coordLabel.Parent = coordFrame

local copyCoordButton = Instance.new("TextButton")
copyCoordButton.Size = UDim2.new(0, 80, 0, 20)
copyCoordButton.Position = UDim2.new(0.5, -40, 0, 45)
copyCoordButton.BackgroundColor3 = Color3.fromRGB(110, 153, 201)
copyCoordButton.Text = "Copiar"
copyCoordButton.TextColor3 = Color3.fromRGB(255, 255, 255)
copyCoordButton.TextSize = 12
copyCoordButton.Font = Enum.Font.SourceSansBold
copyCoordButton.ZIndex = 1001
copyCoordButton.Parent = coordFrame

local uicornerCopyCoord = Instance.new("UICorner")
uicornerCopyCoord.CornerRadius = UDim.new(0, 6)
uicornerCopyCoord.Parent = copyCoordButton

-- Ping Interface
local pingFrame = Instance.new("Frame")
pingFrame.Size = UDim2.new(0, 180, 0, 45)
pingFrame.Position = UDim2.new(0, 10, 1, -130)
pingFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
pingFrame.BorderSizePixel = 0
pingFrame.ZIndex = 1000
pingFrame.Visible = false
pingFrame.Parent = screenGui

local uicornerPing = Instance.new("UICorner")
uicornerPing.CornerRadius = UDim.new(0, 8)
uicornerPing.Parent = pingFrame

local pingTitle = Instance.new("TextLabel")
pingTitle.Size = UDim2.new(1, 0, 0, 15)
pingTitle.Position = UDim2.new(0, 0, 0, 2)
pingTitle.BackgroundTransparency = 1
pingTitle.Text = "Ping"
pingTitle.TextColor3 = Color3.fromRGB(140, 140, 140)
pingTitle.TextSize = 14
pingTitle.Font = Enum.Font.SourceSansBold
pingTitle.ZIndex = 1001
pingTitle.Parent = pingFrame

local pingLabelDisplay = Instance.new("TextLabel")
pingLabelDisplay.Size = UDim2.new(1, -10, 0, 25)
pingLabelDisplay.Position = UDim2.new(0, 5, 0, 17)
pingLabelDisplay.BackgroundTransparency = 1
pingLabelDisplay.Text = "Ping: 0 ms"
pingLabelDisplay.TextColor3 = Color3.fromRGB(255, 255, 255)
pingLabelDisplay.TextSize = 16
pingLabelDisplay.Font = Enum.Font.SourceSans
pingLabelDisplay.ZIndex = 1001
pingLabelDisplay.Parent = pingFrame

-- FPS Interface
local fpsFrame = Instance.new("Frame")
fpsFrame.Size = UDim2.new(0, 180, 0, 45)
fpsFrame.Position = UDim2.new(0, 10, 1, -180)
fpsFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
fpsFrame.BorderSizePixel = 0
fpsFrame.ZIndex = 1000
fpsFrame.Visible = false
fpsFrame.Parent = screenGui

local uicornerFps = Instance.new("UICorner")
uicornerFps.CornerRadius = UDim.new(0, 8)
uicornerFps.Parent = fpsFrame

local fpsTitle = Instance.new("TextLabel")
fpsTitle.Size = UDim2.new(1, 0, 0, 15)
fpsTitle.Position = UDim2.new(0, 0, 0, 2)
fpsTitle.BackgroundTransparency = 1
fpsTitle.Text = "FPS"
fpsTitle.TextColor3 = Color3.fromRGB(140, 140, 140)
fpsTitle.TextSize = 14
fpsTitle.Font = Enum.Font.SourceSansBold
fpsTitle.ZIndex = 1001
fpsTitle.Parent = fpsFrame

local fpsLabelDisplay = Instance.new("TextLabel")
fpsLabelDisplay.Size = UDim2.new(1, -10, 0, 25)
fpsLabelDisplay.Position = UDim2.new(0, 5, 0, 17)
fpsLabelDisplay.BackgroundTransparency = 1
fpsLabelDisplay.Text = "FPS: 0"
fpsLabelDisplay.TextColor3 = Color3.fromRGB(255, 255, 255)
fpsLabelDisplay.TextSize = 16
fpsLabelDisplay.Font = Enum.Font.SourceSans
fpsLabelDisplay.ZIndex = 1001
fpsLabelDisplay.Parent = fpsFrame

-- Drag Functionality for Coordenadas
local draggingCoord, dragInputCoord, dragStartCoord, startPosCoord
coordFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingCoord = true
        dragStartCoord = input.Position
        startPosCoord = coordFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                draggingCoord = false
            end
        end)
    end
end)

coordFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInputCoord = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInputCoord and draggingCoord then
        local delta = input.Position - dragStartCoord
        coordFrame.Position = UDim2.new(startPosCoord.X.Scale, startPosCoord.X.Offset + delta.X, startPosCoord.Y.Scale, startPosCoord.Y.Offset + delta.Y)
    end
end)

-- Drag Functionality for Ping
local draggingPing, dragInputPing, dragStartPing, startPosPing
pingFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingPing = true
        dragStartPing = input.Position
        startPosPing = pingFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                draggingPing = false
            end
        end)
    end
end)

pingFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInputPing = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInputPing and draggingPing then
        local delta = input.Position - dragStartPing
        pingFrame.Position = UDim2.new(startPosPing.X.Scale, startPosPing.X.Offset + delta.X, startPosPing.Y.Scale, startPosPing.Y.Offset + delta.Y)
    end
end)

-- Drag Functionality for FPS
local draggingFps, dragInputFps, dragStartFps, startPosFps
fpsFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        draggingFps = true
        dragStartFps = input.Position
        startPosFps = fpsFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                draggingFps = false
            end
        end)
    end
end)

fpsFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInputFps = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInputFps and draggingFps then
        local delta = input.Position - dragStartFps
        fpsFrame.Position = UDim2.new(startPosFps.X.Scale, startPosFps.X.Offset + delta.X, startPosFps.Y.Scale, startPosFps.Y.Offset + delta.Y)
    end
end)

-- Toggle Update Functions
local function updateCoordenadasToggle(active)
    isCoordActive = active
    coordFrame.Visible = active
    
    local switchColor = active and Color3.fromRGB(110, 153, 201) or Color3.fromRGB(80, 80, 80)
    local knobPos = active and UDim2.new(1, -20, 0, 2) or UDim2.new(0, 2, 0, 2)
    
    coordenadasSwitch.BackgroundColor3 = switchColor
    coordenadasKnob.Position = knobPos
    
    if active then
        spawn(function()
            while isCoordActive and coordFrame.Parent do
                local character = LocalPlayer.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local rootPart = character.HumanoidRootPart
                    local xPos = string.format("%.1f", rootPart.Position.X)
                    local yPos = string.format("%.1f", rootPart.Position.Y)
                    local zPos = string.format("%.1f", rootPart.Position.Z)
                    coordLabel.Text = "X " .. xPos .. " Y " .. yPos .. " Z " .. zPos
                end
                wait(0.1)
            end
        end)
    end
end

local function updatePingToggle(active)
    isPingActive = active
    pingFrame.Visible = active
    
    local switchColor = active and Color3.fromRGB(110, 153, 201) or Color3.fromRGB(80, 80, 80)
    local knobPos = active and UDim2.new(1, -20, 0, 2) or UDim2.new(0, 2, 0, 2)
    
    pingSwitch.BackgroundColor3 = switchColor
    pingKnob.Position = knobPos
    
    if active then
        spawn(function()
            while isPingActive and pingFrame.Parent do
                local ping = math.floor(StatsService.Network.ServerStatsItem["Data Ping"]:GetValue())
                pingLabelDisplay.Text = "Ping: " .. ping .. " ms"
                wait(1.5)
            end
        end)
    end
end

local function updateFpsToggle(active)
    isFpsActive = active
    fpsFrame.Visible = active
    
    local switchColor = active and Color3.fromRGB(110, 153, 201) or Color3.fromRGB(80, 80, 80)
    local knobPos = active and UDim2.new(1, -20, 0, 2) or UDim2.new(0, 2, 0, 2)
    
    fpsSwitch.BackgroundColor3 = switchColor
    fpsKnob.Position = knobPos
    
    if active then
        spawn(function()
            while isFpsActive and fpsFrame.Parent do
                local dt = 0
                for i = 1, 10 do -- Average over 10 frames to slow down updates
                    dt = dt + RunService.Heartbeat:Wait()
                end
                local fps = math.floor(10 / dt + 0.5)
                fpsLabelDisplay.Text = "FPS: " .. fps
            end
        end)
    end
end

local function updatePlayerModsToggle(active)
    isPlayerModsActive = active
    
    local switchColor = active and Color3.fromRGB(110, 153, 201) or Color3.fromRGB(80, 80, 80)
    local knobPos = active and UDim2.new(1, -20, 0, 2) or UDim2.new(0, 2, 0, 2)
    
    playerModsSwitch.BackgroundColor3 = switchColor
    playerModsKnob.Position = knobPos
    
    if active then
        spawn(function()
            while isPlayerModsActive do
                local character = LocalPlayer.Character
                if character and character:FindFirstChild("Humanoid") then
                    local humanoid = character.Humanoid
                    humanoid.WalkSpeed = getWalkSpeed()
                    humanoid.JumpPower = getJumpPower()
                end
                wait(0.1)
            end
        end)
    else
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("Humanoid") then
            local humanoid = character.Humanoid
            humanoid.WalkSpeed = 16
            humanoid.JumpPower = 50
        end
    end
end

-- Copy Coordinates
copyCoordButton.MouseButton1Click:Connect(function()
    local coordText = coordLabel.Text
    local x, y, z = coordText:match("X ([%d.-]+) Y ([%d.-]+) Z ([%d.-]+)")
    if x and y and z then
        local coords = x .. " " .. y .. " " .. z
        setclipboard(coords)
        copyCoordButton.Text = "Copiado!"
        wait(1)
        copyCoordButton.Text = "Copiar"
    else
        warn("Failed to parse coordinates: " .. coordText)
    end
end)

-- Toggle Button Events
coordenadasButton.MouseButton1Click:Connect(function()
    updateCoordenadasToggle(not isCoordActive)
end)

pingButton.MouseButton1Click:Connect(function()
    updatePingToggle(not isPingActive)
end)

fpsButton.MouseButton1Click:Connect(function()
    updateFpsToggle(not isFpsActive)
end)

playerModsButton.MouseButton1Click:Connect(function()
    updatePlayerModsToggle(not isPlayerModsActive)
end)

-- Button Debounce System
local buttonDebounce = {}

local function setupButtonDebounce(button, callback)
    buttonDebounce[button] = false
    button.MouseButton1Click:Connect(function()
        if not buttonDebounce[button] then
            buttonDebounce[button] = true
            local success, err = pcall(callback)
            if not success then
                warn("Button " .. button.Text .. " failed: " .. tostring(err))
            end
            wait(0.5)
            buttonDebounce[button] = false
        end
    end)
end

-- Category Switching System
local currentTab = 1

local function showTab(tabNum)
    currentTab = tabNum
    
    local homeElements = {infiniteYieldButton, simpleSpyButton, dexExplorerButton, remoteFinderV2Button, coordenadasToggle}
    local playerElements = {playerModsToggle, walkSpeedSlider, jumpPowerSlider}
    local settingsElements = {keybindToggle, pingToggle, fpsToggle, rejoinButton, serverHopButton}
    
    for _, elem in pairs(homeElements) do
        elem.Visible = (tabNum == 1)
    end
    for _, elem in pairs(playerElements) do
        elem.Visible = (tabNum == 2)
    end
    for _, elem in pairs(settingsElements) do
        elem.Visible = (tabNum == 3)
    end
    
    tabHome.BackgroundColor3 = (tabNum == 1) and Color3.fromRGB(110, 153, 201) or Color3.fromRGB(50, 50, 50)
    tabPlayer.BackgroundColor3 = (tabNum == 2) and Color3.fromRGB(110, 153, 201) or Color3.fromRGB(50, 50, 50)
    tabSettings.BackgroundColor3 = (tabNum == 3) and Color3.fromRGB(110, 153, 201) or Color3.fromRGB(50, 50, 50)
    
    wait(0.1)
    scrollingFrame.CanvasSize = UDim2.new(0, 0, 0, math.max(uiListLayout.AbsoluteContentSize.Y + 20, 200))
end

-- Tab Click Events
tabHome.MouseButton1Click:Connect(function() 
    showTab(1) 
end)

tabPlayer.MouseButton1Click:Connect(function() 
    showTab(2) 
end)

tabSettings.MouseButton1Click:Connect(function() 
    showTab(3) 
end)

-- Script Loading Functions
setupButtonDebounce(infiniteYieldButton, function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()
end)

setupButtonDebounce(simpleSpyButton, function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/78n/SimpleSpy/main/SimpleSpySource.lua"))()
end)

setupButtonDebounce(dexExplorerButton, function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/infyiff/backup/main/dex.lua"))()
end)

setupButtonDebounce(remoteFinderV2Button, function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/mxx3x/Remote-Finder-v2/refs/heads/main/Remote%20Finder%20v2"))()
end)

-- Rejoin Button
setupButtonDebounce(rejoinButton, function()
    TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
end)

-- Improved ServerHop Button
setupButtonDebounce(serverHopButton, function()
    local found = false
    local cursor = nil
    local currentJobId = game.JobId
    repeat
        local url = "https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"
        if cursor then
            url = url .. "&cursor=" .. cursor
        end
        local success, data = pcall(function()
            return HttpService:JSONDecode(game:HttpGet(url))
        end)
        if success then
            for _, server in pairs(data.data) do
                if server.id ~= currentJobId and server.playing < server.maxPlayers then
                    TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, LocalPlayer)
                    found = true
                    break
                end
            end
            cursor = data.nextPageCursor
        else
            break
        end
    until found or not cursor
    if not found then
        TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, LocalPlayer)
    end
end)

-- KeyBind System
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if isListeningForKeybind and input.UserInputType == Enum.UserInputType.Keyboard then
        currentKeybind = input.KeyCode
        keybindToggle.Text = "KeyBind: " .. input.KeyCode.Name
        isListeningForKeybind = false
        return
    end
    
    if input.KeyCode == currentKeybind then
        isGuiVisible = not isGuiVisible
        mainFrame.Visible = isGuiVisible
    end
end)

-- KeyBind Button
keybindToggle.MouseButton1Click:Connect(function()
    if not isListeningForKeybind then
        isListeningForKeybind = true
        keybindToggle.Text = "Pressione qualquer tecla..."
    end
end)

-- Close Button
setupButtonDebounce(closeButton, function()
    if isCoordActive then
        isCoordActive = false
        if coordFrame then
            coordFrame:Destroy()
        end
    end
    if isPingActive then
        isPingActive = false
        if pingFrame then
            pingFrame:Destroy()
        end
    end
    if isFpsActive then
        isFpsActive = false
        if fpsFrame then
            fpsFrame:Destroy()
        end
    end
    if screenGui then
        screenGui:Destroy()
    end
end)

-- Handle Player Respawn
LocalPlayer.CharacterAdded:Connect(function()
    if screenGui and screenGui.Parent then
        screenGui.Enabled = true
    end
end)

-- Initialize
wait(0.2)
showTab(1)
